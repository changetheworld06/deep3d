<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>{{ title }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="{{ url_for('static', filename='js/interactions.js') }}"></script>
</head>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    // Charger les likes depuis le serveur
    fetch("/likes")
      .then(res => res.json())
      .then(data => {
        document.querySelectorAll(".like-btn").forEach(btn => {
          const projet = btn.dataset.projet;
          const countSpan = btn.querySelector(".like-count");
          countSpan.innerText = data[projet] ?? 0;
  
          // VÃ©rifier si l'utilisateur a dÃ©jÃ  likÃ©
          const liked = localStorage.getItem("liked-" + projet) === "true";
          if (liked) {
            btn.classList.add("liked");
          }
        });
      });
  
    // Clic sur bouton like
    document.querySelectorAll(".like-btn").forEach(btn => {
      btn.addEventListener("click", () => {
        const projet = btn.dataset.projet;
        const countSpan = btn.querySelector(".like-count");
        const liked = btn.classList.contains("liked");
        const action = liked ? "unlike" : "like";
  
        fetch("/like/" + projet, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ action: action })
        })
        .then(res => res.json())
        .then(data => {
          countSpan.innerText = data.likes;
          btn.classList.toggle("liked");
          localStorage.setItem("liked-" + projet, !liked);
        });
      });
    });
  
    // Bouton partage
    document.querySelectorAll(".share-btn").forEach(btn => {
      btn.addEventListener("click", () => {
        const url = btn.dataset.url;
        navigator.clipboard.writeText(url).then(() => {
          btn.textContent = "âœ… Lien copiÃ© !";
          setTimeout(() => { btn.textContent = "ðŸ“¤ Partager"; }, 2000);
        });
      });
    });
  });
  </script>

<body>

  <header>
    <div class="header-container">
      <a href="/" class="logo-link">
        <img src="{{ url_for('static', filename='images/logo.png') }}" class="logo" alt="Deep3D">
      </a>
      <nav class="navbar-links">
        <a href="/">Accueil</a>
        <a href="/articles">Articles</a>
        <a href="/impressions">Impressions 3D</a>
        <a href="/tests">Tests</a>
        <a href="{{ url_for('news') }}">News</a>
        <a href="{{ url_for('guide') }}">Guide</a>
      </nav>
    </div>
  </header>

<main>
    {% block content %}{% endblock %}
</main>

<footer>
    <p>&copy; 2025 Deep3D â€“ Tous droits rÃ©servÃ©s</p>
</footer>

</body>
</html>